<div class="items" *ngIf="cartItems.length > 0">
  <!-- Recorre el carrito y muestra los productos -->
  <div *ngFor="let product of cartItems">
    <div class="product-item">
      <!-- Muestra la información del producto -->
      <img
        class="product-img"
        src="{{ product.urlImage }}"
        alt="Imagen {{ product.model }}"
      />
      <div class="item-text">
        <p>
          <strong>{{ product.brand }} {{ product.model }}</strong>
        </p>
        <p>Precio: ${{ product.price | number : "1.0" }}</p>

        <p>Cantidad: {{ product.stock }}</p>
      </div>
    </div>
  </div>
  <p>Subtotal: ${{ getSubtotal() }}</p>
</div>

<p>Datos cliente</p>

<form [formGroup]="userDataForm">

  <p>Nombre:</p>
  <input type="text" formControlName="name" />
  <div style="color: red" *ngIf="!userDataForm.valid &&(userDataForm.get('name')?.dirty || userDataForm.get('name')?.touched)">
    <div  *ngIf="userDataForm.get('name')?.errors?.['required']" >
      Campo requerido...
    </div>
    <div *ngIf="userDataForm.get('name')?.errors?.['lettersOnly']">
      Debe ingresar solo letras...
    </div>
  </div>
  <br />

  <p>Apellido:</p>
  <input type="text" formControlName="lastname" />
  
  <div style="color: red" *ngIf="!userDataForm.valid &&(userDataForm.get('lastname')?.dirty || userDataForm.get('lastname')?.touched)">
    <div *ngIf="userDataForm.get('lastname')?.errors?.['required']">
      Campo requerido...
    </div>
    <div *ngIf="userDataForm.get('lastname')?.errors?.['lettersOnly']">
      Debe ingresar solo letras...
    </div>
  </div>
  <br />

  <p>Email:</p>
  <input type="text" formControlName="email" />
  <div style="color: red" *ngIf="!userDataForm.valid &&(userDataForm.get('email')?.dirty || userDataForm.get('email')?.touched)">
    <div *ngIf="userDataForm.get('email')?.errors?.['required']">
      Campo requerido...
    </div>
    <div *ngIf="userDataForm.get('email')?.errors?.['email']">
      Email no válido...
    </div>
    <div *ngIf="userDataForm.get('email')?.errors?.['invalidDomain']">
      Dominio no válido...
    </div>
  </div>
  <br />
  <p>Pais:</p>
  <select name="" id="" formControlName="country">
    <option value="Argentina">Argentina</option>
  </select>

  <p>Provincia:</p>
  <select name="" id="" formControlName="province">
    <option value="Buenos Aires">Buenos Aires</option>
  </select>
  <br />
  <p>Ciudad:</p>
  <select name="" id="" formControlName="city">
    <option value="Balcarce">Balcarce</option>
    <option value="Mar del Plata">Mar del Plata</option>
    <option value="Miramar">Miramar</option>
    <option value="Necochea">Necochea</option>
  </select>
  <br />
  <p>Calle:</p>
  <input type="text" formControlName="street"/>
  <p>Número:</p>
  <input type="text" formControlName="streetNumber"/>
  <p>Piso:</p>
  <input type="text" formControlName="floor"/>
  <p>Departamento:</p>
  <input type="text" formControlName="flat"/>

  <!-- Ver que la dirección debería ser calle, numero, piso y depto en el json usuarios -->

  <br />
  <!-- ENVIO -->
  <div *ngIf="userDataForm.get('street')?.valid && userDataForm.get('streetNumber')?.valid">
    <button [disabled]="!userDataForm.get('street')?.valid && !userDataForm.get('streetNumber')?.valid" (click)="getShippingPrice()"> Calcular envio</button>
  </div>
 <div>
    <label style="color: white"> ${{ shippingPrice }}</label>
    <br />
    <label style="color: white" for="">Total ${{ getTotalBuy() }}</label>
  </div>

  <br />
  <select name="" id="" formControlName="cardType">
    <option value="debit">Débito</option>
    <option value="credit">Crédito</option></select
  ><br />
  <input
    type="text"
    formControlName="cardHolder"
    placeholder="Nombre y apellido como figura en la tarjeta"
  /><br />
  <input
    type="text"
    formControlName="cardNumber"
    placeholder="Número de tarjeta"
  /><br />
  <input
    type="text"
    formControlName="expirationDate"
    placeholder="Vencimiento"
  /><br />
  <input type="text" formControlName="cvv" placeholder="CVV" /><br />
  <div >CVV debe ser sólo números</div>
  <select name="" id="" formControlName="cardIssuer">
    <option value="Visa">Visa</option>
    <option value="Mastercard">Mastercard</option>
    <option value="American Express">American Express</option>
    <option value="Discover">Discover</option>
    </select><br />
  <button type="button" (click)="cardExists()">Verificar tarjeta</button><br />

  <button type="submit">Confirmar compra</button>
</form>
